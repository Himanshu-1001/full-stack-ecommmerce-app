(self.webpackChunkapi=self.webpackChunkapi||[]).push([[4056],{87184:(m,h,s)=>{var e=s(39024);function t(o,r){var i=o==null?0:o.length;return!!i&&e(o,r,0)>-1}m.exports=t},10320:m=>{function h(s,e,t){for(var o=-1,r=s==null?0:s.length;++o<r;)if(t(e,s[o]))return!0;return!1}m.exports=h},81768:(m,h,s)=>{var e=s(83504),t=s(87184),o=s(10320),r=s(12480),i=s(85968),d=s(49264),l=200;function c(y,P,j,f){var M=-1,E=t,v=!0,C=y.length,R=[],N=P.length;if(!C)return R;j&&(P=r(P,i(j))),f?(E=o,v=!1):P.length>=l&&(E=d,v=!1,P=new e(P));e:for(;++M<C;){var T=y[M],I=j==null?T:j(T);if(T=f||T!==0?T:0,v&&I===I){for(var S=N;S--;)if(P[S]===I)continue e;R.push(T)}else E(P,I,f)||R.push(T)}return R}m.exports=c},80232:(m,h,s)=>{var e=s(48208),t=s(62632),o=t(e);m.exports=o},58616:m=>{function h(s,e,t,o){for(var r=s.length,i=t+(o?1:-1);o?i--:++i<r;)if(e(s[i],i,s))return i;return-1}m.exports=h},39024:(m,h,s)=>{var e=s(58616),t=s(88124),o=s(22120);function r(i,d,l){return d===d?o(i,d,l):e(i,t,l)}m.exports=r},88124:m=>{function h(s){return s!==s}m.exports=h},22488:(m,h,s)=>{var e=s(80232),t=s(16005);function o(r,i){var d=-1,l=t(r)?Array(r.length):[];return e(r,function(c,y,P){l[++d]=i(c,y,P)}),l}m.exports=o},24576:(m,h,s)=>{var e=s(12480),t=s(64316),o=s(24020),r=s(22488),i=s(92048),d=s(85968),l=s(71456),c=s(45504),y=s(75516);function P(j,f,M){f.length?f=e(f,function(C){return y(C)?function(R){return t(R,C.length===1?C[0]:C)}:C}):f=[c];var E=-1;f=e(f,d(o));var v=r(j,function(C,R,N){var T=e(f,function(I){return I(C)});return{criteria:T,index:++E,value:C}});return i(v,function(C,R){return l(C,R,M)})}m.exports=P},92048:m=>{function h(s,e){var t=s.length;for(s.sort(e);t--;)s[t]=s[t].value;return s}m.exports=h},13052:(m,h,s)=>{var e=s(36792);function t(o,r){if(o!==r){var i=o!==void 0,d=o===null,l=o===o,c=e(o),y=r!==void 0,P=r===null,j=r===r,f=e(r);if(!P&&!f&&!c&&o>r||c&&y&&j&&!P&&!f||d&&y&&j||!i&&j||!l)return 1;if(!d&&!c&&!f&&o<r||f&&i&&l&&!d&&!c||P&&i&&l||!y&&l||!j)return-1}return 0}m.exports=t},71456:(m,h,s)=>{var e=s(13052);function t(o,r,i){for(var d=-1,l=o.criteria,c=r.criteria,y=l.length,P=i.length;++d<y;){var j=e(l[d],c[d]);if(j){if(d>=P)return j;var f=i[d];return j*(f=="desc"?-1:1)}}return o.index-r.index}m.exports=t},62632:(m,h,s)=>{var e=s(16005);function t(o,r){return function(i,d){if(i==null)return i;if(!e(i))return o(i,d);for(var l=i.length,c=r?l:-1,y=Object(i);(r?c--:++c<l)&&d(y[c],c,y)!==!1;);return i}}m.exports=t},22120:m=>{function h(s,e,t){for(var o=t-1,r=s.length;++o<r;)if(s[o]===e)return o;return-1}m.exports=h},92096:(m,h,s)=>{var e=s(12480),t=s(24020),o=s(22488),r=s(75516);function i(d,l){var c=r(d)?e:o;return c(d,t(l,3))}m.exports=i},87144:(m,h,s)=>{var e=s(78456),t=s(24576),o=s(41912),r=s(53492),i=o(function(d,l){if(d==null)return[];var c=l.length;return c>1&&r(d,l[0],l[1])?l=[]:c>2&&r(l[0],l[1],l[2])&&(l=[l[0]]),t(d,e(l,1),[])});m.exports=i},96772:(m,h,s)=>{var e=s(35904);function t(o){var r=o==null?0:o.length;return r?e(o,1,r):[]}m.exports=t},67888:(m,h,s)=>{var e=s(35904),t=s(57628);function o(r,i,d){return r&&r.length?(i=d||i===void 0?1:t(i),e(r,0,i<0?0:i)):[]}m.exports=o},54884:(m,h,s)=>{var e=s(81768),t=s(41912),o=s(90427),r=t(function(i,d){return o(i)?e(i,d):[]});m.exports=r},42616:(m,h,s)=>{"use strict";s.d(h,{G:()=>f,Q:()=>P});var e=s(19968),t=s(62552),o=s(69372),r=s(10900),i=s(37856),d=s(63358),l=s(48936),c=s(5e3);const y=({theme:M,expanded:E,variant:v,disabled:C,error:R})=>R?`1px solid ${M.colors.danger600} !important`:C?`1px solid ${M.colors.neutral150}`:E?`1px solid ${M.colors.primary600}`:v==="primary"?`1px solid ${M.colors.neutral0}`:`1px solid ${M.colors.neutral100}`,P=(0,o.cp)(d.O)``,j=(0,o.cp)(c.k)`
  border: ${y};

  &:hover:not([aria-disabled='true']) {
    border: 1px solid ${({theme:M})=>M.colors.primary600};

    ${P} {
      color: ${({theme:M,expanded:E})=>E?void 0:M.colors.primary700};
    }

    ${d.O} {
      color: ${({theme:M,expanded:E})=>E?void 0:M.colors.primary600};
    }

    & > ${l.C} {
      background: ${({theme:M})=>M.colors.primary100};
    }

    [data-strapi-dropdown='true'] {
      background: ${({theme:M})=>M.colors.primary200};
    }
  }
`,f=({children:M,disabled:E=!1,error:v,expanded:C=!1,hasErrorMessage:R=!0,id:N,onToggle:T,toggle:I,size:S="M",variant:$="primary",shadow:Q})=>{const w=(0,i.I)(N),k=t.useMemo(()=>({expanded:C,onToggle:T,toggle:I,id:w,size:S,variant:$,disabled:E}),[E,C,w,T,S,I,$]);return(0,e.jsxs)(r.O.Provider,{value:k,children:[(0,e.jsx)(j,{"data-strapi-expanded":C,disabled:E,"aria-disabled":E,expanded:C,hasRadius:!0,variant:$,error:v,shadow:Q,children:M}),v&&R&&(0,e.jsx)(c.k,{paddingTop:1,children:(0,e.jsx)(d.O,{variant:"pi",textColor:"danger600",children:v})})]})}},12248:(m,h,s)=>{"use strict";s.d(h,{u:()=>r});var e=s(19968),t=s(10900),o=s(5e3);const r=({children:i,...d})=>{const{expanded:l,id:c}=(0,t.y)();if(!l)return null;const y=`accordion-content-${c}`,P=`accordion-label-${c}`,j=`accordion-desc-${c}`;return(0,e.jsx)(o.k,{role:"region",id:y,"aria-labelledby":P,"aria-describedby":j,...d,children:i})}},10900:(m,h,s)=>{"use strict";s.d(h,{O:()=>t,y:()=>o});var e=s(62552);const t=(0,e.createContext)({disabled:!1,expanded:!1,id:"",size:"M",variant:"primary"}),o=()=>(0,e.useContext)(t)},34404:(m,h,s)=>{"use strict";s.d(h,{M:()=>M});var e=s(19968),t=s(14520),o=s(69372),r=s(42616),i=s(10900);const d=({expanded:E,disabled:v,variant:C})=>{let R="neutral100";return E?R="primary100":v?R="neutral150":C==="primary"&&(R="neutral0"),R};var l=s(82800),c=s(55716),y=s(48936),P=s(63358);const j=(0,o.cp)(l.c)`
  text-align: left;

  // necessary to make the ellipsis prop work on the title
  > span {
    max-width: 100%;
  }

  svg {
    width: ${14/16}rem;
    height: ${14/16}rem;

    path {
      fill: ${({theme:E,expanded:v})=>v?E.colors.primary600:E.colors.neutral500};
    }
  }
`,f=(0,o.cp)(y.C)`
  min-height: ${({theme:E,size:v})=>E.sizes.accordions[v]};
  border-radius: ${({theme:E,expanded:v})=>v?`${E.borderRadius} ${E.borderRadius} 0 0`:E.borderRadius};

  &:hover {
    svg {
      path {
        fill: ${({theme:E})=>E.colors.primary600};
      }
    }
  }
`,M=({title:E,description:v,as:C="span",togglePosition:R="right",action:N,...T})=>{const{onToggle:I,toggle:S,expanded:$,id:Q,size:w,variant:k,disabled:H}=(0,i.y)(),ae=`accordion-content-${Q}`,se=`accordion-label-${Q}`,le=`accordion-desc-${Q}`,Y=w==="M"?6:4,te=w==="M"?Y:Y-2,de=d({expanded:$,disabled:H,variant:k}),ue={as:C,fontWeight:w==="S"?"bold":void 0,id:se,textColor:$?"primary600":"neutral700",ellipsis:!0,variant:w==="M"?"delta":void 0},ge=$?"primary600":"neutral600",pe=$?"primary200":"neutral200",ne=w==="M"?`${32/16}rem`:`${24/16}rem`,q=()=>{H||(S&&!I?(console.warn('Deprecation warning: Usage of "toggle" prop in Accordion component is deprecated. This is discouraged and will be removed in the next major release. Please use "onToggle" instead'),S()):I&&I())},G=(0,e.jsx)(y.C,{justifyContent:"center",borderRadius:"50%",height:ne,width:ne,transform:$?"rotate(180deg)":void 0,"data-strapi-dropdown":!0,"aria-hidden":!0,as:"span",background:pe,cursor:H?"not-allowed":"pointer",onClick:q,shrink:0,children:(0,e.jsx)(c.G,{as:t.c,width:w==="M"?`${11/16}rem`:`${8/16}rem`,color:$?"primary600":"neutral600"})});return(0,e.jsx)(f,{paddingBottom:te,paddingLeft:Y,paddingRight:Y,paddingTop:te,background:de,expanded:$,size:w,justifyContent:"space-between",cursor:H?"not-allowed":"",children:(0,e.jsxs)(y.C,{gap:3,flex:1,maxWidth:"100%",children:[R==="left"&&G,(0,e.jsx)(j,{onClick:q,"aria-disabled":H,"aria-expanded":$,"aria-controls":ae,"aria-labelledby":se,"data-strapi-accordion-toggle":!0,expanded:$,type:"button",flex:1,minWidth:0,...T,children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.Q,{...ue,children:E}),v&&(0,e.jsx)(P.O,{as:"p",id:le,textColor:ge,children:v})]})}),R==="right"&&(0,e.jsxs)(y.C,{gap:3,children:[G,N]}),R==="left"&&N]})})}},74432:(m,h,s)=>{"use strict";s.d(h,{U:()=>o});var e=s(19968),t=s(48936);const o=({startActions:r,endActions:i})=>!r&&!i?null:(0,e.jsxs)(t.C,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,e.jsx)(t.C,{gap:2,wrap:"wrap",children:r}),(0,e.jsx)(t.C,{gap:2,shrink:0,wrap:"wrap",children:i})]})},20596:(m,h,s)=>{"use strict";s.d(h,{_:()=>d});var e=s(19968),t=s(69372),o=s(5e3);const r=(0,t.cp)(o.k)`
  display: grid;
  grid-template-columns: ${({hasSideNav:l})=>l?"auto 1fr":"1fr"};
`,i=(0,t.cp)(o.k)`
  overflow-x: hidden;
`,d=({sideNav:l,children:c})=>(0,e.jsxs)(r,{hasSideNav:Boolean(l),children:[l,(0,e.jsx)(i,{paddingBottom:10,children:c})]})},65280:(m,h,s)=>{"use strict";s.d(h,{c:()=>j});var e=s(19968),t=s(62552),o=s(73648),r=s(39380),i=s(69372),d=s(53744),l=s(63358),c=s(5e3);const y=i.cp.a`
  display: inline-flex;
  align-items: center;
  text-decoration: none;
  pointer-events: ${({disabled:f})=>f?"none":void 0};
  color: ${({disabled:f,theme:M})=>f?M.colors.neutral600:M.colors.primary600};

  svg path {
    transition: fill 150ms ease-out;
    fill: currentColor;
  }

  svg {
    font-size: ${10/16}rem;
  }

  ${l.O} {
    transition: color 150ms ease-out;
    color: currentColor;
  }

  &:hover {
    color: ${({theme:f})=>f.colors.primary500};
  }

  &:active {
    color: ${({theme:f})=>f.colors.primary700};
  }

  ${d.Md};
`,P=(0,i.cp)(c.k)`
  display: flex;
`,j=t.forwardRef(({children:f,href:M,to:E,disabled:v=!1,startIcon:C,endIcon:R,...N},T)=>{const I=M?"_blank":void 0,S=M?"noreferrer noopener":void 0;return(0,e.jsxs)(y,{as:E&&!v?r.Af:"a",target:I,rel:S,to:v?void 0:E,href:v?"#":M,disabled:v,ref:T,...N,children:[C&&(0,e.jsx)(P,{as:"span","aria-hidden":!0,paddingRight:2,children:C}),(0,e.jsx)(l.O,{children:f}),R&&!M&&(0,e.jsx)(P,{as:"span","aria-hidden":!0,paddingLeft:2,children:R}),M&&(0,e.jsx)(P,{as:"span","aria-hidden":!0,paddingLeft:2,children:(0,e.jsx)(o.c,{})})]})})},37776:(m,h,s)=>{"use strict";s.d(h,{c:()=>o});var e=s(19968);const t=r=>(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...r,children:(0,e.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),o=t},46596:(m,h,s)=>{"use strict";s.d(h,{c:()=>o});var e=s(19968);const t=r=>(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...r,children:(0,e.jsx)("path",{fill:"#212134",fillRule:"evenodd",d:"M2.68 9.192c-.6.276-2.114 1.18-2.306 1.303a.792.792 0 0 0-.374.68v1.65a.797.797 0 0 0 .384.687c.254.16 1.73 1.042 2.306 1.303l.744 1.8c-.24.634-.67 2.333-.72 2.554a.797.797 0 0 0 .216.744l1.167 1.166a.801.801 0 0 0 .744.216l.03-.008c.36-.092 1.946-.498 2.523-.712l1.8.744c.276.6 1.181 2.115 1.304 2.307a.805.805 0 0 0 .679.374h1.649a.797.797 0 0 0 .686-.384c.16-.254 1.042-1.73 1.303-2.306l1.8-.744c.634.24 2.333.67 2.554.72a.797.797 0 0 0 .744-.216l1.166-1.167a.803.803 0 0 0 .216-.744l-.008-.03c-.092-.36-.498-1.946-.712-2.523l.744-1.8c.6-.276 2.115-1.181 2.307-1.304a.804.804 0 0 0 .374-.679v-1.649a.796.796 0 0 0-.382-.679c-.254-.16-1.73-1.041-2.306-1.303l-.744-1.8c.24-.634.67-2.333.72-2.554a.796.796 0 0 0-.216-.744l-1.166-1.173a.802.802 0 0 0-.744-.216l-.03.008c-.361.092-1.947.498-2.524.712l-1.8-.744c-.276-.6-1.18-2.115-1.303-2.307a.803.803 0 0 0-.68-.374h-1.65a.797.797 0 0 0-.68.382c-.16.254-1.041 1.73-1.303 2.306l-1.8.744c-.634-.24-2.333-.67-2.554-.72a.797.797 0 0 0-.744.216L2.921 4.094a.802.802 0 0 0-.216.744l.008.03c.092.361.498 1.947.712 2.524l-.744 1.8ZM12 17a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z",clipRule:"evenodd"})}),o=t},94056:(m,h,s)=>{"use strict";s.r(h),s.d(h,{default:()=>ds});var e=s(19968),t=s(16048),o=s(49008),r=s(90896),i=s(62552),d=s(5e3),l=s(48936),c=s(63358),y=s(32568),P=s(28724),j=s(70996),f=s(35480),M=s(42616),E=s(34404),v=s(12248),C=s(48112),R=s(28464),N=s(35676),T=s(42816),I=s(62492),S=s(25352),$=s(65280),Q=s(48744),w=s(76512),k=s(9752),H=s(23264),ae=s(3400),se=s(20596),le=s(74432),Y=s(42848),te=s(20464),de=s(46596),ce=s(53305),ue=s(37776),ge=s(89940),pe=s(71324),ne=s(48636),q=s(54223),G=s(14632),Z=s(48632),b=s(33104),We=s(30840),fe=s(87144),re=s(85676),ee=s(69372),Me=s(29088),me=s(79804),be=s(54884),Ke=s(92096),$e=s(96772),Oe=s(35184),Se=s(67888),he=s(97820);const Pe=(0,i.createContext)({}),je=({children:n,value:a})=>(0,e.jsx)(Pe.Provider,{value:a,children:n}),_e=()=>(0,i.useContext)(Pe);je.propTypes={children:b.node.isRequired,value:b.object.isRequired};function we(n){switch(n){case"application":return"Application";case"plugin::content-manager":return"Content manager";case"plugin::content-type-builder":return"Content types builder";case"plugin::documentation":return"Documentation";case"plugin::email":return"Email";case"plugin::i18n":return"i18n";case"plugin::upload":return"Upload";case"plugin::users-permissions":return"Users-permissions";default:return We(n.replace("api::","").replace("plugin::",""))}}const Fe=(n,a)=>{const u=Object.keys(a).sort().map(g=>({name:g,isOpen:!1}));return{...n,collapses:u}},Ce=(0,ee.gV)`
  background: ${n=>n.theme.colors.primary100};
  svg {
    opacity: 1;
  }
`,Ne=(0,ee.cp)(d.k)`
  display: flex;
  justify-content: space-between;
  align-items: center;

  svg {
    opacity: 0;
    path {
      fill: ${n=>n.theme.colors.primary600};
    }
  }

  /* Show active style both on hover and when the action is selected */
  ${n=>n.isActive&&Ce}
  &:hover {
    ${Ce}
  }
`,ke=ee.cp.div`
  flex: 1;
  align-self: center;
  border-top: 1px solid ${({theme:n})=>n.colors.neutral150};
`,De=({subCategory:n})=>{const{formatMessage:a}=(0,G.c)(),{onChange:u,onChangeSelectAll:g,onSelectedAction:x,selectedAction:p,modifiedData:O}=_e(),A=(0,i.useMemo)(()=>re(O,n.name,{}),[O,n]),D=(0,i.useMemo)(()=>Object.values(A).every(_=>_.enabled===!0),[A]),L=(0,i.useMemo)(()=>Object.values(A).some(_=>_.enabled===!0)&&!D,[A,D]),B=(0,i.useCallback)(({target:{name:_}})=>{g({target:{name:_,value:!D}})},[D,g]),U=(0,i.useCallback)(_=>p===_,[p]);return(0,e.jsxs)(d.k,{children:[(0,e.jsxs)(l.C,{justifyContent:"space-between",alignItems:"center",children:[(0,e.jsx)(d.k,{paddingRight:4,children:(0,e.jsx)(c.O,{variant:"sigma",textColor:"neutral600",children:n.label})}),(0,e.jsx)(ke,{}),(0,e.jsx)(d.k,{paddingLeft:4,children:(0,e.jsx)(y.y,{name:n.name,value:D,onValueChange:_=>B({target:{name:n.name,value:_}}),indeterminate:L,children:a({id:"app.utils.select-all",defaultMessage:"Select all"})})})]}),(0,e.jsx)(l.C,{paddingTop:6,paddingBottom:6,children:(0,e.jsx)(P.y,{gap:2,style:{flex:1},children:n.actions.map(_=>{const W=`${_.name}.enabled`;return(0,e.jsx)(j.C,{col:6,children:(0,e.jsxs)(Ne,{isActive:U(_.name),padding:2,hasRadius:!0,children:[(0,e.jsx)(y.y,{value:re(O,W,!1),name:W,onValueChange:F=>u({target:{name:W,value:F}}),children:_.label}),(0,e.jsxs)("button",{type:"button",onClick:()=>x(_.name),style:{display:"inline-flex",alignItems:"center"},children:[(0,e.jsx)(f.K,{as:"span",children:a({id:"app.utils.show-bound-route",defaultMessage:"Show bound route for {route}"},{route:_.name})}),(0,e.jsx)(de.c,{})]})]})},_.name)})})})]})};De.propTypes={subCategory:b.object.isRequired};const ye=({name:n,permissions:a})=>{const u=(0,i.useMemo)(()=>fe(Object.values(a.controllers).reduce((g,x,p)=>{const O=`${n}.controllers.${Object.keys(a.controllers)[p]}`,A=fe(Object.keys(x).reduce((D,L)=>[...D,{...x[L],label:L,name:`${O}.${L}`}],[]),"label");return[...g,{actions:A,label:Object.keys(a.controllers)[p],name:O}]},[]),"label"),[n,a]);return(0,e.jsx)(d.k,{padding:6,children:u.map(g=>(0,e.jsx)(De,{subCategory:g},g.name))})};ye.propTypes={name:b.string.isRequired,permissions:b.object.isRequired};const Ge={collapses:[]},Qe=(n,a)=>(0,Me.cp)(n,u=>{switch(a.type){case"TOGGLE_COLLAPSE":{u.collapses=n.collapses.map((g,x)=>x===a.index?{...g,isOpen:!g.isOpen}:{...g,isOpen:!1});break}default:return u}}),He=()=>{const{modifiedData:n}=_e(),{formatMessage:a}=(0,G.c)(),[{collapses:u},g]=(0,i.useReducer)(Qe,Ge,p=>Fe(p,n)),x=p=>g({type:"TOGGLE_COLLAPSE",index:p});return(0,e.jsx)(l.C,{direction:"column",alignItems:"stretch",gap:1,children:u.map((p,O)=>(0,e.jsxs)(M.G,{expanded:p.isOpen,onToggle:()=>x(O),variant:O%2===0?"secondary":void 0,children:[(0,e.jsx)(E.M,{title:we(p.name),description:a({id:"users-permissions.Plugin.permissions.plugins.description",defaultMessage:"Define all allowed actions for the {name} plugin."},{name:p.name}),variant:O%2?"primary":"secondary"}),(0,e.jsx)(v.u,{children:(0,e.jsx)(ye,{permissions:n[p.name],name:p.name})})]},p.name))})},ze=n=>{switch(n){case"POST":return{text:"success600",border:"success200",background:"success100"};case"GET":return{text:"secondary600",border:"secondary200",background:"secondary100"};case"PUT":return{text:"warning600",border:"warning200",background:"warning100"};case"DELETE":return{text:"danger600",border:"danger200",background:"danger100"};default:return{text:"neutral600",border:"neutral200",background:"neutral100"}}},Ve=(0,ee.cp)(d.k)`
  margin: -1px;
  border-radius: ${({theme:n})=>n.spaces[1]} 0 0 ${({theme:n})=>n.spaces[1]};
`;function xe({route:n}){const{formatMessage:a}=(0,G.c)(),{method:u,handler:g,path:x}=n,p=x?$e(x.split("/")):[],[O="",A=""]=g?g.split("."):[],D=ze(n.method);return(0,e.jsxs)(l.C,{direction:"column",alignItems:"stretch",gap:2,children:[(0,e.jsxs)(c.O,{variant:"delta",as:"h3",children:[a({id:"users-permissions.BoundRoute.title",defaultMessage:"Bound route to"}),"\xA0",(0,e.jsx)("span",{children:O}),(0,e.jsxs)(c.O,{variant:"delta",textColor:"primary600",children:[".",A]})]}),(0,e.jsxs)(l.C,{hasRadius:!0,background:"neutral0",borderColor:"neutral200",gap:0,children:[(0,e.jsx)(Ve,{background:D.background,borderColor:D.border,padding:2,children:(0,e.jsx)(c.O,{fontWeight:"bold",textColor:D.text,children:u})}),(0,e.jsx)(d.k,{paddingLeft:2,paddingRight:2,children:Ke(p,L=>(0,e.jsxs)(c.O,{textColor:L.includes(":")?"neutral600":"neutral900",children:["/",L]},L))})]})]})}xe.defaultProps={route:{handler:"Nocontroller.error",method:"GET",path:"/there-is-no-path"}},xe.propTypes={route:b.shape({handler:b.string,method:b.string,path:b.string})};const Ye=()=>{const{formatMessage:n}=(0,G.c)(),{selectedAction:a,routes:u}=_e(),g=be(a.split("."),"controllers"),x=re(u,g[0]),p=g.slice(1).join("."),O=me(x)?[]:x.filter(A=>A.handler.endsWith(p));return(0,e.jsx)(j.C,{col:5,background:"neutral150",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,style:{minHeight:"100%"},children:a?(0,e.jsx)(l.C,{direction:"column",alignItems:"stretch",gap:2,children:O.map((A,D)=>(0,e.jsx)(xe,{route:A},D))}):(0,e.jsxs)(l.C,{direction:"column",alignItems:"stretch",gap:2,children:[(0,e.jsx)(c.O,{variant:"delta",as:"h3",children:n({id:"users-permissions.Policies.header.title",defaultMessage:"Advanced settings"})}),(0,e.jsx)(c.O,{as:"p",textColor:"neutral600",children:n({id:"users-permissions.Policies.header.hint",defaultMessage:"Select the application's actions or the plugin's actions and click on the cog icon to display the bound route"})})]})})},Ze=(n,a,u)=>({...n,initialData:a,modifiedData:a,routes:u}),Xe={initialData:{},modifiedData:{},routes:{},selectedAction:"",policies:[]},Je=(n,a)=>(0,Me.cp)(n,u=>{switch(a.type){case"ON_CHANGE":{const g=a.keys.length,x=a.keys[g-1]==="enabled";if(a.value&&x){const p=Se(a.keys,g-1).join(".");u.selectedAction=p}Oe(u,["modifiedData",...a.keys],a.value);break}case"ON_CHANGE_SELECT_ALL":{const g=["modifiedData",...a.keys],x=re(n,g,{}),p=Object.keys(x).reduce((O,A)=>(O[A]={...x[A],enabled:a.value},O),{});Oe(u,g,p);break}case"ON_RESET":{u.modifiedData=n.initialData;break}case"ON_SUBMIT_SUCCEEDED":{u.initialData=n.modifiedData;break}case"SELECT_ACTION":{const{actionToSelect:g}=a;u.selectedAction=g===n.selectedAction?"":g;break}default:return u}}),ve=(0,i.forwardRef)(({permissions:n,routes:a},u)=>{const{formatMessage:g}=(0,G.c)(),[x,p]=(0,i.useReducer)(Je,Xe,B=>Ze(B,n,a));(0,i.useImperativeHandle)(u,()=>({getPermissions(){return{permissions:x.modifiedData}},resetForm(){p({type:"ON_RESET"})},setFormAfterSubmit(){p({type:"ON_SUBMIT_SUCCEEDED"})}}));const L={...x,onChange:({target:{name:B,value:U}})=>p({type:"ON_CHANGE",keys:B.split("."),value:U==="empty__string_value"?"":U}),onChangeSelectAll:({target:{name:B,value:U}})=>p({type:"ON_CHANGE_SELECT_ALL",keys:B.split("."),value:U}),onSelectedAction:B=>p({type:"SELECT_ACTION",actionToSelect:B})};return(0,e.jsx)(je,{value:L,children:(0,e.jsxs)(P.y,{gap:0,shadow:"filterShadow",hasRadius:!0,background:"neutral0",children:[(0,e.jsx)(j.C,{col:7,paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(l.C,{direction:"column",alignItems:"stretch",gap:6,children:[(0,e.jsxs)(l.C,{direction:"column",alignItems:"stretch",gap:2,children:[(0,e.jsx)(c.O,{variant:"delta",as:"h2",children:g({id:(0,r.g)("Plugins.header.title"),defaultMessage:"Permissions"})}),(0,e.jsx)(c.O,{as:"p",textColor:"neutral600",children:g({id:(0,r.g)("Plugins.header.description"),defaultMessage:"Only actions bound by a route are listed below."})})]}),(0,e.jsx)(He,{})]})}),(0,e.jsx)(Ye,{})]})})});ve.propTypes={permissions:b.object.isRequired,routes:b.object.isRequired};const Re=(0,i.memo)(ve),Ae=he.kt().shape({name:he.Qb().required(t.aO.required),description:he.Qb().required(t.aO.required)}),qe=n=>Object.keys(n).reduce((a,u)=>{const g=n[u].controllers,x=Object.keys(g).reduce((p,O)=>(me(g[O])||(p[O]=g[O]),p),{});return me(x)||(a[u]={controllers:x}),a},{}),Le=()=>{const n=(0,t.eo)(),{get:a}=(0,t.Qn)(),{formatAPIError:u}=(0,t.An)(r.g),[{data:g,isLoading:x,error:p,refetch:O},{data:A,isLoading:D,error:L,refetch:B}]=(0,Z.useQueries)([{queryKey:["users-permissions","permissions"],async queryFn(){const{data:{permissions:W}}=await a("/users-permissions/permissions");return W}},{queryKey:["users-permissions","routes"],async queryFn(){const{data:{routes:W}}=await a("/users-permissions/routes");return W}}]),U=async()=>{await Promise.all([O(),B()])};(0,i.useEffect)(()=>{p&&n({type:"warning",message:u(p)})},[n,p,u]),(0,i.useEffect)(()=>{L&&n({type:"warning",message:u(L)})},[n,L,u]);const _=x||D;return{permissions:g?qe(g):{},routes:A??{},getData:U,isLoading:_}},es=()=>{const{formatMessage:n}=(0,G.c)(),a=(0,t.eo)(),{goBack:u}=(0,o.Uz)(),{lockApp:g,unlockApp:x}=(0,t.H6)(),{isLoading:p,permissions:O,routes:A}=Le(),{trackUsage:D}=(0,t.m4)(),L=i.useRef(),{post:B}=(0,t.Qn)(),U=(0,Z.useMutation)(W=>B("/users-permissions/roles",W),{onError(){a({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})},onSuccess(){D("didCreateRole"),a({type:"success",message:{id:(0,r.g)("Settings.roles.created"),defaultMessage:"Role created"}}),u()}}),_=async W=>{g();const F=L.current.getPermissions();await U.mutate({...W,...F,users:[]}),x()};return(0,e.jsxs)(C.G,{children:[(0,e.jsx)(t.K8,{name:"Roles"}),(0,e.jsx)(q.QJ,{enableReinitialize:!0,initialValues:{name:"",description:""},onSubmit:_,validationSchema:Ae,children:({handleSubmit:W,values:F,handleChange:X,errors:K})=>(0,e.jsxs)(t.QF,{noValidate:!0,onSubmit:W,children:[(0,e.jsx)(R.a,{primaryAction:!p&&(0,e.jsx)(N.Z,{type:"submit",loading:U.isLoading,startIcon:(0,e.jsx)(ce.c,{}),children:n({id:"global.save",defaultMessage:"Save"})}),title:n({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:n({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"})}),(0,e.jsx)(T.S,{children:(0,e.jsxs)(l.C,{background:"neutral0",direction:"column",alignItems:"stretch",gap:7,hasRadius:!0,paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,shadow:"filterShadow",children:[(0,e.jsxs)(l.C,{direction:"column",alignItems:"stretch",children:[(0,e.jsx)(c.O,{variant:"delta",as:"h2",children:n({id:(0,r.g)("EditPage.form.roles"),defaultMessage:"Role details"})}),(0,e.jsxs)(P.y,{gap:4,children:[(0,e.jsx)(j.C,{col:6,children:(0,e.jsx)(I.g,{name:"name",value:F.name||"",onChange:X,label:n({id:"global.name",defaultMessage:"Name"}),error:K?.name?n({id:K.name,defaultMessage:"Name is required"}):!1,required:!0})}),(0,e.jsx)(j.C,{col:6,children:(0,e.jsx)(S.A,{id:"description",value:F.description||"",onChange:X,label:n({id:"global.description",defaultMessage:"Description"}),error:K?.description?n({id:K.description,defaultMessage:"Description is required"}):!1,required:!0})})]})]}),!p&&(0,e.jsx)(Re,{ref:L,permissions:O,routes:A})]})})]})})]})},ss=()=>(0,e.jsx)(t.rF,{permissions:r.P.createRole,children:(0,e.jsx)(es,{})}),ts=()=>{const{formatMessage:n}=(0,G.c)(),a=(0,t.eo)(),{lockApp:u,unlockApp:g}=(0,t.H6)(),{params:{id:x}}=(0,o.SU)("/settings/users-permissions/roles/:id"),{get:p}=(0,t.Qn)(),{isLoading:O,routes:A}=Le(),{data:D,isLoading:L,refetch:B}=(0,Z.useQuery)(["users-permissions","role",x],async()=>{const{data:{role:K}}=await p(`/users-permissions/roles/${x}`);return K}),U=i.useRef(),{put:_}=(0,t.Qn)(),{formatAPIError:W}=(0,t.An)(),F=(0,Z.useMutation)(K=>_(`/users-permissions/roles/${x}`,K),{onError(K){a({type:"warning",message:W(K)})},async onSuccess(){a({type:"success",message:{id:(0,r.g)("Settings.roles.created"),defaultMessage:"Role edited"}}),await B()}}),X=async K=>{u();const z=U.current.getPermissions();await F.mutate({...K,...z,users:[]}),g()};return L?(0,e.jsx)(t.Wm,{}):(0,e.jsxs)(C.G,{children:[(0,e.jsx)(t.K8,{name:"Roles"}),(0,e.jsx)(q.QJ,{enableReinitialize:!0,initialValues:{name:D.name,description:D.description},onSubmit:X,validationSchema:Ae,children:({handleSubmit:K,values:z,handleChange:oe,errors:J})=>(0,e.jsxs)(t.QF,{noValidate:!0,onSubmit:K,children:[(0,e.jsx)(R.a,{primaryAction:!O&&(0,e.jsx)(N.Z,{disabled:D.code==="strapi-super-admin",type:"submit",loading:F.isLoading,startIcon:(0,e.jsx)(ce.c,{}),children:n({id:"global.save",defaultMessage:"Save"})}),title:D.name,subtitle:D.description,navigationAction:(0,e.jsx)(t.cH,{startIcon:(0,e.jsx)(ue.c,{}),to:"/settings/users-permissions/roles",children:n({id:"global.back",defaultMessage:"Back"})})}),(0,e.jsx)(T.S,{children:(0,e.jsxs)(l.C,{background:"neutral0",direction:"column",alignItems:"stretch",gap:7,hasRadius:!0,paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,shadow:"filterShadow",children:[(0,e.jsxs)(l.C,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(c.O,{variant:"delta",as:"h2",children:n({id:(0,r.g)("EditPage.form.roles"),defaultMessage:"Role details"})}),(0,e.jsxs)(P.y,{gap:4,children:[(0,e.jsx)(j.C,{col:6,children:(0,e.jsx)(I.g,{name:"name",value:z.name||"",onChange:oe,label:n({id:"global.name",defaultMessage:"Name"}),error:J?.name?n({id:J.name,defaultMessage:"Name is required"}):!1,required:!0})}),(0,e.jsx)(j.C,{col:6,children:(0,e.jsx)(S.A,{id:"description",value:z.description||"",onChange:oe,label:n({id:"global.description",defaultMessage:"Description"}),error:J?.description?n({id:J.description,defaultMessage:"Description is required"}):!1,required:!0})})]})]}),!O&&(0,e.jsx)(Re,{ref:U,permissions:D.permissions,routes:A})]})})]})})]})},ns=()=>(0,e.jsx)(t.rF,{permissions:r.P.updateRole,children:(0,e.jsx)(ts,{})}),rs=(0,ee.cp)($.c)`
  align-items: center;
  height: ${(0,t.W8)(32)};
  display: flex;
  justify-content: center;
  padding: ${({theme:n})=>`${n.spaces[2]}}`};
  width: ${(0,t.W8)(32)};

  svg {
    height: ${(0,t.W8)(12)};
    width: ${(0,t.W8)(12)};

    path {
      fill: ${({theme:n})=>n.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:n})=>n.colors.neutral800};
      }
    }
  }
`,Ee=({sortedRoles:n,canDelete:a,permissions:u,setRoleToDelete:g,onDelete:x})=>{const{formatMessage:p}=(0,G.c)(),{push:O}=(0,o.Uz)(),[A,D]=x,L=_=>a&&!["public","authenticated"].includes(_.type),B=_=>{g(_),D(!A)},U=_=>{O(`/settings/users-permissions/roles/${_}`)};return(0,e.jsx)(Q.K,{children:n?.map(_=>(0,e.jsxs)(w.Tr,{...(0,t.on)({fn:()=>U(_.id)}),children:[(0,e.jsx)(k.Td,{width:"20%",children:(0,e.jsx)(c.O,{children:_.name})}),(0,e.jsx)(k.Td,{width:"50%",children:(0,e.jsx)(c.O,{children:_.description})}),(0,e.jsx)(k.Td,{width:"30%",children:(0,e.jsx)(c.O,{children:p({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {# user} one {# user} other {# users}}"},{number:_.nb_users})})}),(0,e.jsx)(k.Td,{children:(0,e.jsxs)(l.C,{justifyContent:"end",...t.Ii,children:[(0,e.jsx)(t.Yj,{permissions:u.updateRole,children:(0,e.jsx)(rs,{to:`/settings/users-permissions/roles/${_.id}`,"aria-label":p({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:`${_.name}`}),children:(0,e.jsx)(ge.c,{})})}),L(_)&&(0,e.jsx)(t.Yj,{permissions:u.deleteRole,children:(0,e.jsx)(H.w,{onClick:()=>B(_.id),noBorder:!0,icon:(0,e.jsx)(pe.c,{}),label:p({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${_.name}`})})})]})})]},_.name))})};Ee.defaultProps={canDelete:!1},Ee.propTypes={onDelete:b.array.isRequired,permissions:b.object.isRequired,setRoleToDelete:b.func.isRequired,sortedRoles:b.array.isRequired,canDelete:b.bool};const os=async(n,a)=>{try{const{get:u}=(0,t.YF)(),{data:g}=await u("/users-permissions/roles");return a("The roles have loaded successfully"),g}catch(u){throw n({type:"warning",message:{id:"notification.error"}}),new Error(u)}},is=async(n,a)=>{try{const{del:u}=(0,t.YF)();await u(`/users-permissions/roles/${n}`)}catch{a({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}},as=()=>{const{trackUsage:n}=(0,t.m4)(),{formatMessage:a,locale:u}=(0,G.c)(),g=(0,t.eo)(),{notifyStatus:x}=(0,ae.O)(),[{query:p}]=(0,t.WK)(),O=p?._q||"",[A,D]=(0,i.useState)(!1),[L,B]=(0,i.useState)(!1),[U,_]=(0,i.useState)();(0,t.G0)();const{isLoading:W,allowedActions:{canRead:F,canDelete:X}}=(0,t.aU)({create:r.P.createRole,read:r.P.readRoles,update:r.P.updateRole,delete:r.P.deleteRole}),{isLoading:K,data:{roles:z},isFetching:oe,refetch:J}=(0,Z.useQuery)("get-roles",()=>os(g,x),{initialData:{},enabled:F}),{includes:Te}=(0,t.WO)(u,{sensitivity:"base"}),Be=(0,t.In)(u,{sensitivity:"base"}),Ie=K||oe,cs=()=>{D(!A)},us={roles:{id:(0,r.g)("Roles.empty"),defaultMessage:"You don't have any roles yet."},search:{id:(0,r.g)("Roles.empty.search"),defaultMessage:"No roles match the search."}},gs=a({id:"global.roles",defaultMessage:"Roles"}),ps=(0,Z.useMutation)(V=>is(V,g),{async onSuccess(){await J()}}),ms=async()=>{B(!0),await ps.mutateAsync(U),D(!A),B(!1)},ie=(z||[]).filter(V=>Te(V.name,O)||Te(V.description,O)).sort((V,Ue)=>Be.compare(V.name,Ue.name)||Be.compare(V.description,Ue.description)),hs=O&&!ie.length?"search":"roles",_s=4,xs=(z?.length||0)+1;return(0,e.jsxs)(se._,{children:[(0,e.jsx)(t.K8,{name:gs}),(0,e.jsxs)(C.G,{"aria-busy":Ie,children:[(0,e.jsx)(R.a,{title:a({id:"global.roles",defaultMessage:"Roles"}),subtitle:a({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),primaryAction:(0,e.jsx)(t.Yj,{permissions:r.P.createRole,children:(0,e.jsx)(t.EZ,{to:"/settings/users-permissions/roles/new",onClick:()=>n("willCreateRole"),startIcon:(0,e.jsx)(ne.c,{}),size:"S",children:a({id:(0,r.g)("List.button.roles"),defaultMessage:"Add new role"})})})}),(0,e.jsx)(le.U,{startActions:(0,e.jsx)(t.w9,{label:a({id:"app.component.search.label",defaultMessage:"Search"})})}),(0,e.jsxs)(T.S,{children:[!F&&(0,e.jsx)(t.o5,{}),(Ie||W)&&(0,e.jsx)(t.Wm,{}),F&&ie&&ie?.length?(0,e.jsxs)(Y.o,{colCount:_s,rowCount:xs,children:[(0,e.jsx)(te.o,{children:(0,e.jsxs)(w.Tr,{children:[(0,e.jsx)(k.Th,{children:(0,e.jsx)(c.O,{variant:"sigma",textColor:"neutral600",children:a({id:"global.name",defaultMessage:"Name"})})}),(0,e.jsx)(k.Th,{children:(0,e.jsx)(c.O,{variant:"sigma",textColor:"neutral600",children:a({id:"global.description",defaultMessage:"Description"})})}),(0,e.jsx)(k.Th,{children:(0,e.jsx)(c.O,{variant:"sigma",textColor:"neutral600",children:a({id:"global.users",defaultMessage:"Users"})})}),(0,e.jsx)(k.Th,{children:(0,e.jsx)(f.K,{children:a({id:"global.actions",defaultMessage:"Actions"})})})]})}),(0,e.jsx)(Ee,{sortedRoles:ie,canDelete:X,permissions:r.P,setRoleToDelete:_,onDelete:[A,D]})]}):(0,e.jsx)(t.Su,{content:us[hs]})]}),(0,e.jsx)(t.cz,{isConfirmButtonLoading:L,onConfirm:ms,onToggleDialog:cs,isOpen:A})]})]})},ls=()=>(0,e.jsx)(t.rF,{permissions:r.P.accessRoles,children:(0,e.jsx)(as,{})}),ds=()=>(0,e.jsx)(t.rF,{permissions:r.P.accessRoles,children:(0,e.jsxs)(o.Wk,{children:[(0,e.jsx)(o.kX,{path:"/settings/users-permissions/roles/new",component:ss,exact:!0}),(0,e.jsx)(o.kX,{path:"/settings/users-permissions/roles/:id",component:ns,exact:!0}),(0,e.jsx)(o.kX,{path:"/settings/users-permissions/roles",component:ls,exact:!0}),(0,e.jsx)(o.kX,{path:"",component:t.wF})]})})}}]);
