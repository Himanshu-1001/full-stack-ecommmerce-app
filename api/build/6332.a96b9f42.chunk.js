"use strict";(self.webpackChunkapi=self.webpackChunkapi||[]).push([[6332],{6841:(h,g,t)=>{t.d(g,{D:()=>O});var s=t(19968),e=t(5e3),l=t(60124);function M(D,d,E){if(!D||!d||!E)return{display:"none"};const{x:P,y:n}=E;return{transform:`translate(${P}px, ${n}px)`}}const O=({renderItem:D})=>{const{itemType:d,isDragging:E,item:P,initialOffset:n,currentOffset:c,mouseOffset:_}=(0,l.useDragLayer)(r=>({item:r.getItem(),itemType:r.getItemType(),initialOffset:r.getInitialSourceClientOffset(),currentOffset:r.getSourceClientOffset(),isDragging:r.isDragging(),mouseOffset:r.getClientOffset()}));return E?(0,s.jsx)(e.k,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%",children:(0,s.jsx)(e.k,{style:M(n,c,_),children:D({type:d,item:P})})}):null}},63096:(h,g,t)=>{t.d(g,{B:()=>R,D:()=>w,H:()=>j,R:()=>B});var s=t(19968),e=t(48936),l=t(63358),M=t(20596),O=t(48112),D=t(42816),d=t(28464),E=t(16048),P=t(14520),n=t(37776),c=t(14632),_=t(6841),r=t(48132),m=t(33104),o=t(69372);const A=(0,o.cp)(e.C)`
  svg path {
    fill: ${({theme:f})=>f.colors.neutral600};
  }
`;function T({name:f}){return(0,s.jsxs)(e.C,{background:"primary100",borderStyle:"dashed",borderColor:"primary600",borderWidth:"1px",gap:3,hasRadius:!0,padding:3,shadow:"tableShadow",width:(0,E.W8)(300),children:[(0,s.jsx)(A,{alignItems:"center",background:"neutral200",borderRadius:"50%",height:6,justifyContent:"center",width:6,children:(0,s.jsx)(P.c,{width:`${8/16}rem`})}),(0,s.jsx)(l.O,{fontWeight:"bold",children:f})]})}T.propTypes={name:m.string.isRequired};function x({type:f,item:v}){switch(f){case r.D.STAGE:return(0,s.jsx)(T,{...v});default:return null}}function w(){return(0,s.jsx)(_.D,{renderItem:x})}function B({children:f}){return(0,s.jsx)(M._,{children:(0,s.jsx)(O.G,{tabIndex:-1,children:(0,s.jsx)(D.S,{children:f})})})}function R({href:f}){const{formatMessage:v}=(0,c.c)();return(0,s.jsx)(E.cH,{startIcon:(0,s.jsx)(n.c,{}),to:f,children:v({id:"global.back",defaultMessage:"Back"})})}function j({title:f,subtitle:v,navigationAction:p,primaryAction:y}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.K8,{name:f}),(0,s.jsx)(d.a,{navigationAction:p,primaryAction:y,title:f,subtitle:v})]})}},6332:(h,g,t)=>{t.r(g),t.d(g,{default:()=>J});var s=t(19968),e=t(16048),l=t(70516),M=t(61952),O=t(62552),D=t(48936),d=t(89296),E=t(42848),P=t(89616),n=t(20464),c=t(76512),_=t(9752),r=t(63358),m=t(35480),o=t(48744),A=t(23264),T=t(48636),x=t(89940),w=t(71324),B=t(14632),R=t(48632),j=t(49008),f=t(69372),v=t(50040),p=t(34564),y=t(63096),U=t(46276),C=t(48132),Z=t(70064),Dt=t(17892),gt=t(31212),Mt=t(60056),Ot=t(54320),ft=t(5240),Pt=t(91892),mt=t(36196),vt=t(20880),ut=t(21424),ht=t(54223),Ct=t(18424),Tt=t(97820),Lt=t(99568),yt=t(21968),It=t(12132),Wt=t(85676),At=t(35184),xt=t(96556),wt=t(6841);const V=(0,f.cp)(e.cH)`
  align-items: center;
  height: ${(0,e.W8)(32)};
  display: flex;
  justify-content: center;
  padding: ${({theme:a})=>`${a.spaces[2]}}`};
  width: ${(0,e.W8)(32)};

  svg {
    height: ${(0,e.W8)(12)};
    width: ${(0,e.W8)(12)};

    path {
      fill: ${({theme:a})=>a.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:a})=>a.colors.neutral800};
      }
    }
  }
`;function Y(){const{formatMessage:a}=(0,B.c)(),{push:F}=(0,j.Uz)(),{collectionTypes:X,singleTypes:b,isLoading:q}=(0,v.u)(),{meta:L,workflows:k,isLoading:K,refetch:tt}=(0,Z.u)(),[H,S]=O.useState(null),[st,I]=O.useState(!1),{del:et}=(0,e.Qn)(),{formatAPIError:nt}=(0,e.An)(),N=(0,e.eo)(),{getFeature:at,isLoading:Q}=(0,p.u)(),{trackUsage:z}=(0,e.m4)(),ot=(0,l.w1)(M.s),{allowedActions:{canCreate:G,canDelete:it}}=(0,e.aU)(ot.settings["review-workflows"]),u=at("review-workflows"),{mutateAsync:rt,isLoading:_t}=(0,R.useMutation)(async({workflowId:i,stages:W})=>{const{data:{data:$}}=await et(`/admin/review-workflows/workflows/${i}`,{data:W});return $},{onSuccess(){N({type:"success",message:{id:"notification.success.deleted",defaultMessage:"Deleted"}})}}),lt=i=>[...X,...b].find($=>$.uid===i).info.displayName,dt=i=>{S(i)},Et=()=>{S(null)},ct=async()=>{try{const i=await rt({workflowId:H});return await tt(),S(null),i}catch(i){return N({type:"warning",message:nt(i)}),null}};return O.useEffect(()=>{!K&&!Q&&u?.[C.C]&&L?.workflowCount>parseInt(u[C.C],10)&&I(!0)},[Q,K,u,L?.workflowCount,L.workflowsTotal]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.H,{primaryAction:G&&(0,s.jsx)(e.EZ,{startIcon:(0,s.jsx)(T.c,{}),size:"S",to:"/settings/review-workflows/create",onClick:i=>{u?.[C.C]&&L?.workflowCount>=parseInt(u[C.C],10)?(i.preventDefault(),I(!0)):z("willCreateWorkflow")},children:a({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})}),subtitle:a({id:"Settings.review-workflows.list.page.subtitle",defaultMessage:"Manage your content review process"}),title:a({id:"Settings.review-workflows.list.page.title",defaultMessage:"Review Workflows"})}),(0,s.jsxs)(y.R,{children:[K||q?(0,s.jsx)(D.C,{justifyContent:"center",children:(0,s.jsx)(d.c,{children:a({id:"Settings.review-workflows.page.list.isLoading",defaultMessage:"Workflows are loading"})})}):(0,s.jsxs)(E.o,{colCount:3,footer:G&&(0,s.jsx)(P.U,{icon:(0,s.jsx)(T.c,{}),onClick:()=>{u?.[C.C]&&L?.workflowCount>=parseInt(u[C.C],10)?I(!0):(F("/settings/review-workflows/create"),z("willCreateWorkflow"))},children:a({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})}),rowCount:1,children:[(0,s.jsx)(n.o,{children:(0,s.jsxs)(c.Tr,{children:[(0,s.jsx)(_.Th,{children:(0,s.jsx)(r.O,{variant:"sigma",children:a({id:"Settings.review-workflows.list.page.list.column.name.title",defaultMessage:"Name"})})}),(0,s.jsx)(_.Th,{children:(0,s.jsx)(r.O,{variant:"sigma",children:a({id:"Settings.review-workflows.list.page.list.column.stages.title",defaultMessage:"Stages"})})}),(0,s.jsx)(_.Th,{children:(0,s.jsx)(r.O,{variant:"sigma",children:a({id:"Settings.review-workflows.list.page.list.column.contentTypes.title",defaultMessage:"Content Types"})})}),(0,s.jsx)(_.Th,{children:(0,s.jsx)(m.K,{children:a({id:"Settings.review-workflows.list.page.list.column.actions.title",defaultMessage:"Actions"})})})]})}),(0,s.jsx)(o.K,{children:k.map(i=>(0,O.createElement)(c.Tr,{...(0,e.on)({fn(W){W.target.nodeName!=="BUTTON"&&F(`/settings/review-workflows/${i.id}`)}}),key:`workflow-${i.id}`},(0,s.jsx)(_.Td,{width:(0,e.W8)(250),children:(0,s.jsx)(r.O,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:i.name})}),(0,s.jsx)(_.Td,{children:(0,s.jsx)(r.O,{textColor:"neutral800",children:i.stages.length})}),(0,s.jsx)(_.Td,{children:(0,s.jsx)(r.O,{textColor:"neutral800",children:(i?.contentTypes??[]).map(lt).join(", ")})}),(0,s.jsx)(_.Td,{children:(0,s.jsxs)(D.C,{alignItems:"center",justifyContent:"end",children:[(0,s.jsx)(V,{to:`/settings/review-workflows/${i.id}`,"aria-label":a({id:"Settings.review-workflows.list.page.list.column.actions.edit.label",defaultMessage:"Edit {name}"},{name:i.name}),children:(0,s.jsx)(x.c,{})}),k.length>1&&it&&(0,s.jsx)(A.w,{"aria-label":a({id:"Settings.review-workflows.list.page.list.column.actions.delete.label",defaultMessage:"Delete {name}"},{name:"Default workflow"}),icon:(0,s.jsx)(w.c,{}),noBorder:!0,onClick:()=>{dt(i.id)}})]})})))})]}),(0,s.jsx)(e.cz,{bodyText:{id:"Settings.review-workflows.list.page.delete.confirm.body",defaultMessage:"If you remove this worfklow, all stage-related information will be removed for this content-type. Are you sure you want to remove it?"},isConfirmButtonLoading:_t,isOpen:!!H,onToggleDialog:Et,onConfirm:ct}),(0,s.jsxs)(U.L,{isOpen:st,onClose:()=>I(!1),children:[(0,s.jsx)(U.T,{children:a({id:"Settings.review-workflows.list.page.workflows.limit.title",defaultMessage:"You\u2019ve reached the limit of workflows in your plan"})}),(0,s.jsx)(U.B,{children:a({id:"Settings.review-workflows.list.page.workflows.limit.body",defaultMessage:"Delete a workflow or contact Sales to enable more workflows."})})]})]})]})}function J(){const a=(0,l.w1)(M.s);return(0,s.jsx)(e.rF,{permissions:a.settings["review-workflows"].main,children:(0,s.jsx)(Y,{})})}},50040:(h,g,t)=>{t.d(g,{u:()=>O});var s=t(62552),e=t(16048),l=t(78164),M=t(48632);function O(){const{get:D}=(0,e.Qn)(),{formatAPIError:d}=(0,e.An)(),E=(0,e.eo)(),P=(0,M.useQueries)([{queryKey:["content-manager","components"],async queryFn(){const{data:{data:o}}=await D("/content-manager/components");return o},onError(o){o instanceof l.Uh&&E({type:"warning",message:d(o)})}},{queryKey:["content-manager","content-types"],async queryFn(){const{data:{data:o}}=await D("/content-manager/content-types");return o},onError(o){o instanceof l.Uh&&E({type:"warning",message:d(o)})}}]),[n,c]=P,_=n.isLoading||c.isLoading,r=s.useMemo(()=>(c?.data??[]).filter(o=>o.kind==="collectionType"&&o.isDisplayed),[c?.data]),m=s.useMemo(()=>(c?.data??[]).filter(o=>o.kind!=="collectionType"&&o.isDisplayed),[c?.data]);return{isLoading:_,components:s.useMemo(()=>n?.data??[],[n?.data]),collectionTypes:r,singleTypes:m}}},70064:(h,g,t)=>{t.d(g,{u:()=>M});var s=t(62552),e=t(16048),l=t(48632);function M(O={}){const{get:D}=(0,e.Qn)(),{id:d="",...E}=O,P={populate:"stages"},{data:n,isLoading:c,status:_,refetch:r}=(0,l.useQuery)(["review-workflows","workflows",d],async()=>(await D(`/admin/review-workflows/workflows/${d}`,{params:{...P,...E}})).data),m=s.useMemo(()=>d&&n?.data?[n.data]:Array.isArray(n?.data)?n.data:[],[n?.data,d]);return{meta:s.useMemo(()=>n?.meta??{},[n?.meta]),workflows:m,isLoading:c,status:_,refetch:r}}},89616:(h,g,t)=>{t.d(g,{U:()=>P});var s=t(19968),e=t(69372),l=t(5e3),M=t(6912),O=t(48936),D=t(63358);const d=(0,e.cp)(l.k)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:n})=>n.colors.primary600};
  }
`,E=(0,e.cp)(l.k)`
  border-radius: 0 0 ${({theme:n})=>n.borderRadius} ${({theme:n})=>n.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,P=({children:n,icon:c,..._})=>(0,s.jsxs)("div",{children:[(0,s.jsx)(M.c,{}),(0,s.jsx)(E,{as:"button",background:"primary100",padding:5,..._,children:(0,s.jsxs)(O.C,{children:[(0,s.jsx)(d,{"aria-hidden":!0,background:"primary200",children:c}),(0,s.jsx)(l.k,{paddingLeft:3,children:(0,s.jsx)(D.O,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:n})})]})})]})},37776:(h,g,t)=>{t.d(g,{c:()=>l});var s=t(19968);const e=M=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 24 24",...M,children:(0,s.jsx)("path",{fill:"#212134",d:"M24 13.3a.2.2 0 0 1-.2.2H5.74l8.239 8.239a.2.2 0 0 1 0 .282L12.14 23.86a.2.2 0 0 1-.282 0L.14 12.14a.2.2 0 0 1 0-.282L11.86.14a.2.2 0 0 1 .282 0L13.98 1.98a.2.2 0 0 1 0 .282L5.74 10.5H23.8c.11 0 .2.09.2.2v2.6Z"})}),l=e}}]);
