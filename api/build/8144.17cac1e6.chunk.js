"use strict";(self.webpackChunkapi=self.webpackChunkapi||[]).push([[8144],{28144:(ts,c,s)=>{s.r(c),s.d(c,{CreatePage:()=>v,default:()=>Q});var t=s(19968),m=s(62552),B=s(48112),I=s(28464),l=s(48936),g=s(35676),U=s(42816),d=s(5e3),h=s(63358),f=s(28724),C=s(70996),T=s(62492),W=s(25352),i=s(16048),K=s(37776),u=s(61748),j=s(54223),p=s(79804),x=s(14632),y=s(70516),R=s(49008),S=s(69372),$=s(61952),E=s(51168),M=s(97820),es=s(48632),as=s(17892),is=s(31212),ns=s(60056),os=s(54320),ds=s(5240),_s=s(91892),ls=s(36196),rs=s(20880),Es=s(21424),Ms=s(18424),Ds=s(99568),Ps=s(21968),Os=s(12132),cs=s(85676),ms=s(35184),gs=s(96556),hs=s(56781),Cs=s(87144),Rs=s(30680),vs=s(30840),As=s(99256),Ls=s(38955);const F=M.kt().shape({name:M.Qb().required(i.aO.required),description:M.Qb().required(i.aO.required)}),N=S.cp.div`
  border: 1px solid ${({theme:e})=>e.colors.primary200};
  background: ${({theme:e})=>e.colors.primary100};
  padding: ${({theme:e})=>`${e.spaces[2]} ${e.spaces[4]}`};
  color: ${({theme:e})=>e.colors.primary600};
  border-radius: ${({theme:e})=>e.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,v=()=>{const e=(0,R.SU)("/settings/roles/duplicate/:id"),A=(0,i.eo)(),{lockApp:z,unlockApp:H}=(0,i.H6)(),{formatMessage:a}=(0,x.c)(),[V,D]=(0,m.useState)(!1),{replace:Z}=(0,R.Uz)(),P=(0,m.useRef)(),{trackUsage:r}=(0,i.m4)(),{post:G,put:J}=(0,i.Qn)(),{params:_}=e??{},{isLoading:X,data:Y}=(0,E.u)(_?.id,{cacheTime:0}),{permissions:b,isLoading:k}=(0,E.a)({id:_?.id},{cacheTime:0,enabled:!!_?.id}),w=O=>{z(),D(!0),_?.id?r("willDuplicateRole"):r("willCreateNewRole"),Promise.resolve(G("/admin/roles",O)).then(async({data:n})=>{const{permissionsToSend:o}=P.current.getPermissions();return _?.id?r("didDuplicateRole"):r("didCreateNewRole"),n.data.id&&!p(o)&&await J(`/admin/roles/${n.data.id}/permissions`,{permissions:o}),n}).then(n=>{D(!1),A({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Z(`/settings/roles/${n.data.id}`)}).catch(n=>{console.error(n),D(!1),A({type:"warning",message:{id:"notification.error"}})}).finally(()=>{H()})},q=`${a({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,u.c)(new Date,"PPP")}`;return(0,t.jsxs)(B.G,{children:[(0,t.jsx)(i.K8,{name:"Roles"}),(0,t.jsx)(j.QJ,{initialValues:{name:"",description:q},onSubmit:w,validationSchema:F,validateOnChange:!1,children:({handleSubmit:O,values:n,errors:o,handleReset:ss,handleChange:L})=>(0,t.jsx)(i.QF,{noValidate:!0,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.a,{primaryAction:(0,t.jsxs)(l.C,{gap:2,children:[(0,t.jsx)(g.Z,{variant:"secondary",onClick:()=>{ss(),P.current.resetForm()},size:"L",children:a({id:"app.components.Button.reset",defaultMessage:"Reset"})}),(0,t.jsx)(g.Z,{onClick:O,loading:V,size:"L",children:a({id:"global.save",defaultMessage:"Save"})})]}),title:a({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:a({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:(0,t.jsx)(i.cH,{startIcon:(0,t.jsx)(K.c,{}),to:"/settings/roles",children:a({id:"global.back",defaultMessage:"Back"})})}),(0,t.jsx)(U.S,{children:(0,t.jsxs)(l.C,{direction:"column",alignItems:"stretch",gap:6,children:[(0,t.jsx)(d.k,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0,children:(0,t.jsxs)(l.C,{direction:"column",alignItems:"stretch",gap:4,children:[(0,t.jsxs)(l.C,{justifyContent:"space-between",children:[(0,t.jsxs)(d.k,{children:[(0,t.jsx)(d.k,{children:(0,t.jsx)(h.O,{fontWeight:"bold",children:a({id:"global.details",defaultMessage:"Details"})})}),(0,t.jsx)(d.k,{children:(0,t.jsx)(h.O,{variant:"pi",textColor:"neutral600",children:a({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})})})]}),(0,t.jsx)(N,{children:a({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0})})]}),(0,t.jsxs)(f.y,{gap:4,children:[(0,t.jsx)(C.C,{col:6,children:(0,t.jsx)(T.g,{name:"name",error:o.name&&a({id:o.name}),label:a({id:"global.name",defaultMessage:"Name"}),onChange:L,required:!0,value:n.name})}),(0,t.jsx)(C.C,{col:6,children:(0,t.jsx)(W.A,{label:a({id:"global.description",defaultMessage:"Description"}),id:"description",error:o.description&&a({id:o.description}),onChange:L,children:n.description})})]})]})}),!X&&!k?(0,t.jsx)(d.k,{shadow:"filterShadow",hasRadius:!0,children:(0,t.jsx)(E.P,{isFormDisabled:!1,ref:P,permissions:b,layout:Y})}):(0,t.jsx)(d.k,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0,children:(0,t.jsx)(i.Wm,{})})]})})]})})})]})};function Q(){const e=(0,y.w1)($.s);return(0,t.jsx)(i.rF,{permissions:e.settings.roles.create,children:(0,t.jsx)(v,{})})}}}]);
